# UX設計原則

> モダンで使いやすいユーザー体験を実現するための設計原則

## 目次

1. [高速な体感](#1-高速な体感)
2. [スムーズなインタラクション](#2-スムーズなインタラクション)
3. [直感的なナビゲーション](#3-直感的なナビゲーション)
4. [レスポンシブ設計](#4-レスポンシブ設計)
5. [アクセシビリティ](#5-アクセシビリティ)
6. [フィードバック](#6-フィードバック)
7. [パーソナライゼーション](#7-パーソナライゼーション)

---

## 1. 高速な体感

ユーザーが「速い」と感じるための施策。

### プリフェッチ

```
┌─────────────────────────────────────┐
│  サークル一覧                        │
│  ┌─────────┐  ┌─────────┐          │
│  │ Circle A │  │ Circle B │ ← hover │
│  └─────────┘  └─────────┘          │
│                    ↓                │
│         次ページをプリロード          │
└─────────────────────────────────────┘
```

- リンクホバー時に次ページのデータをプリロード
- TanStack Routerの`preload`機能を活用
- ネットワーク状況に応じて動的に調整

### Optimistic UI

- 操作の結果を即座に画面に反映
- サーバー応答を待たずにUIを更新
- エラー時はロールバック

### スケルトンローディング

```
読み込み中:
┌─────────────────────────────────────┐
│ ████████████████████                │ ← タイトル
│ ██████████                          │ ← サブタイトル
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│ │░░░░░│ │░░░░░│ │░░░░░│ │░░░░░│   │ ← カード
│ │░░░░░│ │░░░░░│ │░░░░░│ │░░░░░│   │
│ └─────┘ └─────┘ └─────┘ └─────┘   │
└─────────────────────────────────────┘
```

- コンテンツ構造を先に表示
- ユーザーに読み込み状況を伝達
- 実際のコンテンツと同じレイアウト

### インクリメンタル表示

- 重要コンテンツを優先的に表示
- Above the fold（ファーストビュー）を最優先
- 画像は遅延読み込み（Lazy Loading）

---

## 2. スムーズなインタラクション

操作に対する自然な反応。

### マイクロアニメーション

```css
/* ボタンホバー */
.btn {
  transition: transform 150ms ease, box-shadow 150ms ease;
}
.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

/* カード展開 */
.card {
  transition: all 200ms ease;
}
.card:hover {
  transform: scale(1.02);
}
```

**適用箇所:**
- ボタンホバー・クリック
- カードホバー
- ドロップダウン展開
- タブ切替

### ページ遷移

- View Transitions API を活用
- ページ間のスムーズなフェード
- 共有要素のアニメーション

```typescript
// TanStack Routerでの実装例
const router = createRouter({
  // View Transitions APIを有効化
  defaultViewTransition: true,
});
```

### スクロール復元

```
┌──────────────┐     ┌──────────────┐     ┌──────────────┐
│ 一覧ページ    │ ──→ │ 詳細ページ    │ ──→ │ 一覧ページ    │
│ スクロール位置 │     │              │     │ 位置を復元    │
│    ↓ 500px   │     │              │     │    ↓ 500px   │
└──────────────┘     └──────────────┘     └──────────────┘
```

- 一覧→詳細→戻るで位置を記憶
- ブラウザ履歴と連携
- sessionStorageで状態管理

### プルダウンリフレッシュ（モバイル）

- スワイプダウンで更新
- 視覚的フィードバック
- ネイティブアプリライクな操作感

---

## 3. 直感的なナビゲーション

迷わずに目的地へ到達できる設計。

### キーボードショートカット

| キー | アクション |
|------|-----------|
| `/` | 検索バーにフォーカス |
| `Esc` | モーダル・ドロワーを閉じる |
| `Tab` | 次の要素にフォーカス |
| `Shift+Tab` | 前の要素にフォーカス |

### フォーカス管理

```
Tab移動の順序:
[ロゴ] → [ナビ1] → [ナビ2] → [検索] → [テーマ] → [メニュー]
   ↓
[メインコンテンツ]
   ↓
[フッター]
```

- 論理的なTab順序
- フォーカストラップ（モーダル内）
- Skip to content リンク

### パンくずリスト

```
ホーム > アーティスト > [アーティスト名]
```

**仕様:**
- 常に現在地を表示
- 最後の項目は非リンク（現在地）
- モバイルでは折りたたみ

```
モバイル:
... > アーティスト > [名前]
     ↓ タップで展開
ホーム > アーティスト > [名前]
```

### 戻るボタン

- 文脈に応じた遷移先
- 詳細ページ→一覧ページ
- ブラウザ履歴と連携

---

## 4. レスポンシブ設計

あらゆるデバイスで最適な体験。

### モバイルファースト

```
設計順序:
モバイル (< 640px)
    ↓
タブレット (640px - 1024px)
    ↓
デスクトップ (> 1024px)
```

### ブレークポイント

| 名前 | サイズ | 用途 |
|------|--------|------|
| sm | 640px | タブレット縦 |
| md | 768px | タブレット横 |
| lg | 1024px | デスクトップ |
| xl | 1280px | ワイドスクリーン |

### タッチフレンドリー

```
最小タップ領域: 44px × 44px

┌────────────────────┐
│                    │
│  ┌──────────────┐  │
│  │    44px      │  │ ← 実際のボタン
│  │    ×         │  │
│  │    44px      │  │
│  └──────────────┘  │
│                    │
└────────────────────┘
      ↑ タップ領域
```

### スワイプジェスチャー

- カルーセル: 左右スワイプ
- タブ: 左右スワイプで切替
- モーダル: 下スワイプで閉じる

---

## 5. アクセシビリティ

誰もが使えるインターフェース。

### ARIA属性

```html
<!-- ナビゲーション -->
<nav aria-label="メインナビゲーション">
  <ul role="menubar">
    <li role="none">
      <a role="menuitem" href="/artists">アーティスト</a>
    </li>
  </ul>
</nav>

<!-- 検索 -->
<input
  type="search"
  aria-label="サイト内検索"
  aria-describedby="search-hint"
/>
<span id="search-hint" class="sr-only">
  アーティスト名、サークル名、曲名で検索できます
</span>

<!-- タブ -->
<div role="tablist" aria-label="コンテンツタブ">
  <button role="tab" aria-selected="true" aria-controls="panel-1">
    リリース
  </button>
  <button role="tab" aria-selected="false" aria-controls="panel-2">
    曲一覧
  </button>
</div>
```

### 色コントラスト

WCAG AA準拠（4.5:1以上）

| 用途 | 前景色 | 背景色 | コントラスト比 |
|------|--------|--------|---------------|
| 本文 | #374151 | #ffffff | 10.69:1 |
| リンク | #2563eb | #ffffff | 4.54:1 |
| 薄い文字 | #6b7280 | #ffffff | 5.34:1 |

### フォーカスリング

```css
/* キーボード操作時のみ表示 */
:focus-visible {
  outline: 2px solid #2563eb;
  outline-offset: 2px;
}

/* マウス操作時は非表示 */
:focus:not(:focus-visible) {
  outline: none;
}
```

### 減色モーション対応

```css
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
```

---

## 6. フィードバック

ユーザーに状態を明確に伝える。

### ローディング状態

```
┌─────────────────────────────────────┐
│ [Spinner]  読み込み中...             │
│                                     │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│ │░░░░░│ │░░░░░│ │░░░░░│ │░░░░░│   │ ← Skeleton
│ └─────┘ └─────┘ └─────┘ └─────┘   │
└─────────────────────────────────────┘
```

### エラー状態

```
┌─────────────────────────────────────┐
│                                     │
│         ┌─────────────┐             │
│         │   (>_<)     │             │
│         │  エラー発生  │             │
│         └─────────────┘             │
│                                     │
│  データの取得に失敗しました           │
│                                     │
│        [再試行する]                  │
│                                     │
└─────────────────────────────────────┘
```

- 明確なエラーメッセージ
- 再試行ボタン
- 問題解決のヒント

### 空状態

```
┌─────────────────────────────────────┐
│                                     │
│         ┌─────────────┐             │
│         │   (・_・)    │             │
│         │  見つかりません │            │
│         └─────────────┘             │
│                                     │
│  「○○」に一致する結果はありません      │
│                                     │
│  - 別のキーワードで検索してみる       │
│  - フィルターを解除してみる           │
│                                     │
│        [検索をクリア]                │
│                                     │
└─────────────────────────────────────┘
```

### 成功状態

- インライン表示またはバナー
- 控えめで明確なフィードバック
- 自動で消える（3-5秒）

```
┌─────────────────────────────────────┐
│ ✓ URLをコピーしました                │
└─────────────────────────────────────┘
```

---

## 7. パーソナライゼーション

ユーザーの好みに合わせた体験。

### テーマ切替

```
[☀️ ライト] [🌙 ダーク] [💻 システム]
```

- 3つの選択肢
- システム設定との連携
- localStorageで保存

### 表示設定保存

```typescript
// localStorage構造
{
  "viewMode": "grid" | "list",
  "theme": "light" | "dark" | "system",
  "filters": {
    "circles": { "script": "all" },
    "artists": { "script": "all", "role": "all" },
    "events": { "view": "series" }
  }
}
```

### 検索履歴

```
最近の検索:
┌─────────────────────────────────────┐
│ 🕐 東方紅魔郷                        │
│ 🕐 IOSYS                            │
│ 🕐 ナイト・オブ・ナイツ               │
└─────────────────────────────────────┘
```

- 直近10件を保存
- クリックで再検索
- クリアボタン

### URL同期

フィルター状態をURLパラメータで共有可能:

```
/artists?script=kana&role=vocal
/events?view=year&year=2024
/circles?script=alphabet
```

- ブックマーク可能
- 共有可能
- ブラウザ履歴と連携
